CREATE TABLE TBUsuarios(
    ATId_Usuario INT GENERATED BY DEFAULT ON NULL AS IDENTITY,
	ATNombre varchar(50),
    ATApellido_1 varchar(50),
	ATApellido_2 varchar(50),
    ATCedula varchar(30),
    ATActivo char(1) check ( ATActivo in ( '0', '1' )),
    ATRol varchar(50),
    ATId_Correo int,
    ATId_Telefono int,
    PRIMARY KEY(ATId_usuario,ATId_Correo,ATId_Telefono)
);

ALTER TABLE TBUsuarios ADD CONSTRAINT fk_usuarios_correos FOREIGN KEY (ATId_Correo) REFERENCES TBCorreo (ATId_Correo);
ALTER TABLE TBUsuarios ADD CONSTRAINT fk_usuarios_telefonos FOREIGN KEY (ATId_Telefono) REFERENCES TBTelefono (ATId_Telefono);

CREATE TABLE TBDonante(
    ATId_Donante INT GENERATED BY DEFAULT ON NULL AS IDENTITY,
	ATNombre varchar(50),
    ATApellido_1 varchar(50),
	ATApellido_2 varchar(50),
    ATCedula varchar(30),
    ATId_Correo int,
    ATId_Telefono int,
    PRIMARY KEY(ATId_Donante,ATId_Correo,ATId_Telefono)
);

ALTER TABLE TBDonante ADD CONSTRAINT fk_donantes_correos FOREIGN KEY (ATId_Correo) REFERENCES TBCorreo (ATId_Correo);
ALTER TABLE TBDonante ADD CONSTRAINT fk_donantes_telefonos FOREIGN KEY (ATId_Telefono) REFERENCES TBTelefono (ATId_Telefono);

CREATE TABLE TBDonatario(
    ATId_Donatario INT GENERATED BY DEFAULT ON NULL AS IDENTITY,
	ATNombre varchar(50),
    ATApellido_1 varchar(50),
	ATApellido_2 varchar(50),
    ATCedula varchar(30),
    ATId_Correo int,
    ATId_Telefono int,
    PRIMARY KEY(ATId_Donatario,ATId_Correo,ATId_Telefono)
);

ALTER TABLE TBDonatario ADD CONSTRAINT fk_donatario_correos FOREIGN KEY (ATId_Correo) REFERENCES TBCorreo (ATId_Correo);
ALTER TABLE TBDonatario ADD CONSTRAINT fk_donatario_telefonos FOREIGN KEY (ATId_Telefono) REFERENCES TBTelefono (ATId_Telefono);

CREATE TABLE TBDonacion(
    ATId_Donacion INT GENERATED BY DEFAULT ON NULL AS IDENTITY,
	ATFecha date,
    ATProcedencia  varchar(80),
    ATCantidad int,
    ATDescripcion varchar(500),
    ATTipoDonacion varchar(60),
    ATId_Usuario int,
    ATId_Donante int,
    ATId_Donatario int,
    ATId_Sede int,
    PRIMARY KEY(ATId_Donacion,ATId_Usuario,ATId_Donante,ATId_Donatario,ATId_Sede)
);

ALTER TABLE TBDonacion ADD CONSTRAINT fk_donacion_usuario FOREIGN KEY (ATId_Usuario) REFERENCES TBUsuarios (ATId_usuario);
ALTER TABLE TBDonacion ADD CONSTRAINT fk_donacion_donante FOREIGN KEY (ATId_Donante) REFERENCES TBDonante (ATId_Donante);
ALTER TABLE TBDonacion ADD CONSTRAINT fk_donacion_donatario FOREIGN KEY (ATId_Donatario) REFERENCES TBDonatario (ATId_Donatario);
ALTER TABLE TBDonacion ADD CONSTRAINT fk_donacion_sede FOREIGN KEY (ATId_Sede) REFERENCES TBSede (ATId_Sede);


CREATE TABLE TBSede(
    ATId_Sede INT GENERATED BY DEFAULT ON NULL AS IDENTITY,
	ATCedula_Juridica varchar(50),
    ATId_Localizacion int,
    ATId_Correo int,
    ATId_Telefono int,
    PRIMARY KEY(ATId_Sede,ATId_Correo,ATId_Telefono)
);

ALTER TABLE TBSede ADD CONSTRAINT fk_sede_correos FOREIGN KEY (ATId_Correo) REFERENCES TBCorreo (ATId_Correo);
ALTER TABLE TBSede ADD CONSTRAINT fk_sede_telefonos FOREIGN KEY (ATId_Telefono) REFERENCES TBTelefono (ATId_Telefono);
ALTER TABLE TBSede ADD CONSTRAINT fk_sede_localizacion FOREIGN KEY (ATId_Localizacion) REFERENCES TBLocalizacion (ATId_Localizacion);

CREATE TABLE TBCorreo(
    ATId_Correo INT GENERATED BY DEFAULT ON NULL AS IDENTITY,
	ATCorreo varchar(150),
    PRIMARY KEY(ATId_correo)
);

CREATE TABLE TBTelefono(
    ATId_telefono INT GENERATED BY DEFAULT ON NULL AS IDENTITY,
	ATTelefono varchar(150),
    PRIMARY KEY(ATId_telefono)
);

CREATE TABLE TBLocalizacion(
    ATId_Localizacion INT GENERATED BY DEFAULT ON NULL AS IDENTITY,
	ATProvincia varchar(50),
    ATCanton varchar(50),
    ATDistrito varchar(50),
    ATDireccionExacta varchar(50),
    PRIMARY KEY(ATId_Localizacion)
);
